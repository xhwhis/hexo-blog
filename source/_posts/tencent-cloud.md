---
title: cloud
top: false
toc: true
mathjax: false
tags: 云服务
categories: 云服务
abbrlink: 226
date: 2020-10-25 10:18:29
author:
img:
coverImg:
password: liang111
summary:
---
云服务入门

连长：其实这个，这个早熟的人吧，通常都晚熟
骄傲的人又很急性，这两样我都占了
我认识一个人
就他 他每做一件小事的时候
他都像救命稻草一样抓着
有一天我一看
嚯 好家伙
他抱着的是已经让我仰望的参天大树了

连长：对，这要搁以前，他做什么事我都瞧不上
执拗的像个傻子
可现在这么一看
这个信念这玩意儿
真不是说出来的 是做出来的



### 云计算基础介绍

#### 企业自建EDC
什么是EDC:
数据中心的分层：

l4: 业务应用层: 各种应用系统(ERP,CRM,OA系统等)

l3: 应用支撑层: 中间件，信息调度，集成开发环境，API/SDK等.

l3: 数据分析层: 数据库，数据仓库，BI系统．

l2: IT基础设备层: 服务器,网络,存储,安全.

l1: 机房设施层: 电源,制冷,机柜,布线等

l0: 楼宇系统层: 机房，传输，安保，防火等.


#### 数据中心等级(T1-T4)

T4;双活容错：两地三中心机制，同时两个数据中心同时提供服务，(负载均衡),一方出错，自动转换到另一方.

T3:并行维护：主系统和备用系统同时运行(随时切换)

T2:冗余组件：离线备份

T1:基本容量：不备份．



依据：
1. 可靠性，安全性.
2. 运维管理能力.
3. 基础设施可靠性.

主要衡量标准
可用性=(承诺服务时间-宕(dang)机)/承诺服务时间*100%

宕机: 业务不可用时间.

##### 面临挑战
1. 建设难度高，运维管理复杂．
2. 扩展调整不便，上线周期长．
##### TCP总成本较高

TCO = CapEx + OpeEx + OppCost
＝后边分别是
采购与部署数据中心所花费的成本
数据中心的运营成本(运维，人员，电费支出)
机汇成本（设备的损失造成的成本）



##### TVO总拥有价值不明显

TVO = IT带来的业务价值与收益.

#### IDC托管/租用

机房资源解决方案:

1. IDC资源出租(空间，主机，带宽)，分为托管型，租用型.
优点：快速上线，准备少，维护少．
IDC:　运营商等提供的资源的出租．


托管型：
运营商提供:机房资源，带宽接入，电力维护
企业提供: 购买硬件，管理维护，业务系统.

租用型：
运营商提供: 机房资源，带宽接入，电力公园，硬件投入，管理维护．
企业提供：业务系统．


2. 相比EDC:成本更低，上线更快，标准化，电信级可靠性，运维管理等．

#### 云计算定义

云计算：按需收费，按量收费．
NIST(国家标准局)定义: 云计算是一种按需使用，按量付费的服务模式，提供可用的，便捷的，按需的网络访问，可配置的计算资源共享池．


云计算：像电一样使用IT
IT发展：　［企业自建数据中心］=> IDC托管/租用 =>　　云计算,按需使用
类比电力　　独立自建　　　　　　　部分租用　　　　　　　　按需使用
电力发展：［工厂自建发电设备］=> 工厂租用发电厂设备 => 电厂统一供电，按需使用

互联网+ :能源产业互联网.


#### 云计算对比

　　　　　　自建EDC　　　　传统IDC　　　　　　云计算
租用范围　　　０　　　　L0,L1,部分L2　　　　　　L0-L4
总体成本　　　高　　　　　　中　　　　　　　　　低
上线时间　　　慢　　　　　　一般　　　　　　　　很快
运维管理　　　复杂　　　　　一般　　　　　　　　简单
扩展性　　　　很难　　　　　一般　　　　　　　　弹性扩展
自主可控　　　高　　　　　　中　　　　　　　　　(公有云/私有云)

#### 2.5云计算参考模型

服务目录三个类
1. 软件即服务　SaaS
2. 平台即服务　PaaS
3. 基础设施即服务　IaaS

服务编排调度系统：给以上三类服务编排调度．

服务生命周期管理：服务的产生，计费，运维，销毁等．

虚拟化基础设施：基于物理基础设施上做了一个然硬件的隔离，一个虚拟资源池提供（存储池，计算池，网络池）．
物理基础设施：

运维管理系统：给机器的配置，应用等的管理.


两个性能：安全性，合规性．

向云计算转型变革的特点
1. 资源池化
2. 弹性扩展
3. 按需服务
4. 泛网络访问
5. 服务可度量

#### 云计算关键特点
　　　　按需服务　－＞　资源池化　－＞　　弹性扩展　－＞　泛网络访问　－＞　服务可度量
关键词：资源/时间　提高利用率/可用性　业务需求/成本均衡　随时随地/高质量　服务计费/精细化运营


从资源的维度：节约设备，搭建，维护等成本．资源利用率提高.

从时间的维度：节约了开发上线的时间．按需提供灵活．


#### 云计算服务模式

自建系统:（全部都得建立，一下三种模式需要使用者安装的直接写序号，和自检系统形成对比,不写的是服务商提供的）
1. 服务使用
2. 应用层
3. 中间层
4. 基础设施

服务模式：
SaaS:　soft　as　a　service　软件及服务：1,2,3,
PaaS: platform　as　a　service 平台及服务: 1,2,
IaaS: infrastructure as a service 基础设施及服务:1

根据序号发展情况：租用范围变小，成本更低，上线更快，运维管理更简单，自主可控程度变小(唯一不足).



云计算技术架构与服务模式对应关系：

－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－


SaaS:(应用层)　　Protal(服务界面)　CRM(客户关系管理系统)　ERP(企业资源管理系统)　OA(办公系统)　其他企业


－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
　　　　　　　　　访问控制　　负载均衡　　开发工具　服务总线
PaaS:(中间层)　　　　　　　　　　　中间件
　　　　　　　　　　　　　　　　　数据库

－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
　　　　　　　　　计算资源池　存储资源池　网络资源池　其他资源池
IaaS:(基础架构层)　　　　　　　　虚拟化
　　　　　　　　　主机　　　　存储　　　　网络　　　　其他基础设施

－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－



#### 云计算四种部署方式

1. 公有云:AWS，云服务

2. 私有云: 某行私有云，腾讯专有云．
私有化的安装和部署，满足安全性要求自己可操控，金融或政府．
　
3. 混合云:公有云+私有云和多云互通.
未来的主流形式
使用混合网关．
公私结合云：核心数据在私有云，不重要的数据放在公有云上．达到成本和安全性的均衡．
多云互通：一部分部署在阿里云，一部分部署云服务，一部分部署百度云，一起提供服务．


4. 行业云: 金融行业云，教育行业云．

也是公有云：对特定的行业做了特定的优化的．

业务痛点：
1. 标准通用的公有云难以满足特定的行业定制化需求，主要因业务理解不足，技术储备不够或定制成本太高． 

解决方案：
1. 行业云：是针对特定行业深度优化的公有云，可以理解为产业互联网．
类型一：　共有云厂商带领行业伙伴搞行业解决方案，如云服务智慧零售．
类型二：　行业头部厂商整合IT能力出售给其他企业使用，如招商银行创．


公有云和私有云对比　　公有云　　　　　　　　　　　　　　私有云

云厂商和云用户　　　　不同组织，多用户　　　　　　　　相同组织单用户

底层资源　　　　　　　使用权属于客户　　　　　　　　　使用权属于客户
　　　　　　　　　　　所有资源属于服务商　　　　　　　所有权属于客户

总体成本　　　　　　　较低　　　　　　　　　　　　　　较高

运维复杂度　　　　　　较简单　　　　　　　　　　　　　较复杂

自主可控　　　　　　　较低　　　　　　　　　　　　　　较高



#### 计算虚拟化

虚拟化前：
1. 每台计算机运行单一操作系统．
2. 软件必须与硬件资源强耦合
3. 资源利用率低，扩展性与容错性差．

虚拟化后：
1. 裸金属架构，虚拟化层直接运行在硬件上．
2. 提供虚拟cpu与内存资源池,多VM(虚拟机)共享．
3. 软件与硬件解耦,可故障迁移，弹性扩展．

计算机虚拟化分类：

全虚拟化：GuestOS直接运行在虚拟化层上，无需进行修改，如ESXI;


半虚拟化：GuestOS需要修改安装额外的驱动，如Xen上linux　VM 是半虚拟化需要安装PV Driver,而Windows VM 是全虚拟化无需修改.

全虚拟化:

比如：ESXI
Ring 3 : User APP
Ring 2 : 
Ring 1 : GuestOS
Ring 0 : 虚拟机化层
主机硬件

相关指令需要通过虚拟机化层进行二进制转换然后设置操作系统然后再依次返回.

Ring 3 -> Ring 1 -> Ring 0 (Os特权指令通过BT(二进制转换)转换执行)

半虚拟化: XEN 

ing 3 : User APP
Ring 2 : 
Ring 1 : 
Ring 0 :  PV GuestOS
Ring 0 : 虚拟机化层
主机硬件

ing 3 -> Ring 0 -> Ring 0 (Os特权指令超级调用Hypercall.

性能优越.


Ring 3 : User APP
Ring 2 : 
Ring 1 : 
Ring 0 : GuestOS
 虚拟机化层
主机硬件
Ring(0-3): 为根模式,
下边两层为:非根模式. 

ing 3 -> Ring 0 -> 虚拟化层 -> 主机硬件 (Os特权指令切换到根模式)


#### 分布式存储

分布式数据存储ServerSAN
　　　　　　　　　
　　　　　　　　　　应用

存储资源池 　控制元<-读写元 　分布式存储层
若干存储元链接读写元　　　　存储元
箭头指向应用->读写元->存储元

保存有三副本

原理:
1. 通过分布存储层将服务器上分散的本地盘整合成统一的存储资源池.
2. 读写元承接应用I/O,控制元通过Hash算法确保I/O均匀分布到各节点,存储元负责写数据到对应的存储块.
优势:
1. 性价比: 普通服务器上本地磁盘可保障高性能.
2. 易扩展:实时线性的增加或减少节点或存储.
3. 高可靠性:数据保存3副本,快速故障迁移/修复.


#### 网络虚拟化

软件定义网络SDN

应用层：业务应用
			API
控制层：控制软件　网络服务
　　　　控制数据接口
基础设施层：网络设备

区别　　　　　　软件定义网络SDN 　　　　　　网络功能虚拟化NFV
　
核心特征　　　控制平面和数据平面分离　　　　网络功能与硬件解耦
				通过路由器和交换机　　　　　商业化硬件代替专用硬件
				控制平面可编程　　　　　　　数据平面可编程

应用场景　　　　园区网，数据中心网　　　　　运营商基础网络

优化点　　　　　处理OSI中2-3层优化交换机　　　处理OSI是4-7层，优化网络的功能　　（第一层物理层）
　　　　　　　　路由器，无线等　　　　　　　负载均衡，防火墙，WAN网优化等．　　

收益　　　　　　成本优化，快速上线，简化运维，灵活扩展．


#### 云管理平台OpenStack

OpenStack是一个开源的云计算管理平台，
优势：
1. 开源项目
2. 兼容各种云平台
3. 标准统一规范

劣势：
1. 部署运维升级复杂
2. 性能与扩展性较差
3. 容下能力不足

没有被广泛应用


服务器名及相关功能
Nova -> 计算机服务
Neutron->网络服务
Keystone->认证预授权服务
Glance-> 镜像服务
Swift -> 对象存储服务
Cinder->块区存取
Horizon->图形化管理界面
Ceilometer->监控计量服务
Heat->编排服务调度.


云服务VStation架构


#### 应用虚拟化 容器技术

容器技术: 是一种轻量级虚拟化技术，通过进程隔离，将应用软件及其运行所依赖的资源与配置打包封装，提供独立可移植的运行环境.

　虚拟化技术　　　　　　　容器技术

　　APP　　　　　　　　　　　APP
　Bins/Libs               Bins/Libs
　GuestOS     －－－－－＞　容器引擎
　虚拟化层　　　　　　　　虚拟化层
　服务器硬件　　　　　　　服务器硬件

Docker容器：

最流行的容器技术，标准化，强移植，目标：Build,Ship and Run Ant APP,Anywhere.一处构建多处布置.

容器管理：
K8S是开源的容器编排管理调度技术．

容器优势:
1. 及其轻量：轻量打包，资源少，性能佳．
2. 秒级部署: 容器部署在毫秒与秒之间．
3. 易移植性：标准化，一次构建，随处部署．
4. 弹性伸缩：通过编排工具可快速扩展/收缩.


#### 大数据和AI

未来互联网就是利用人工智能在云端处理大数据．－－－Pony Ma
应用：大数据(精准营销/决策支持/风控)，AI(图像/语言/自动驾驶)

大数据4V特点: 
1. 数据量大
2. 多样化
3. 高速产生
4. 价值密度低

人工智能；
1. 算法
2. 大数据
3. 计算力
4. 边界清晰


#### 云计算发展阶段

虚拟化－＞服务化－＞产业化－＞标准化

#### 云计算产业影响

互联网　　－＞　　　互联网＋　　－＞　　　　产业互联网

链接人　　　　　    连接服务　　　　　　     连接企业

用户到用户         企业－＞平台－＞用户     用户->平台->企业->用户

C2C					B2B2C　　　　　　　　　　C2B2B2C(闭环)
企业到用户
B2C


信息技术助力产业智变

归纳三个关键词

1. 连接：网络化：数字世界与现实世界连接(互联网，移动互联网等)
2. 交换：融合化：数字世界与现实世界互动（数字孪生，虚拟世界，机器人，3D/4D打印）
3. 计算：数字化：智能化（两个世界数据转换，存储和处理）人工智能，大数据，云计算．

产业互联网框架的５点维度
　　　　　　传统产业　　　　产业互动互联网
　　　
1. 市场　　单一　　　　　　融合：供应与需求精准匹配，产业与产业跨界协同

2. 产品　　物理　　　　　　数字：物理产品嵌套数字功能，产品软件服务化

3. 运营　　人工　　　　　　人机：基于数据和算法的人机协同运营

4. 组织　　层级　　　　　　弹性：网络化，扁平化，自适应

5. 系统　　垂直　　　　　　互联：基础设施共享＋综合技术应用＋平台开放　　　　　　



#### 云计算组织影响

对客户的影响：

1. 成本优化：a.采购运维成本　　b.提高资源利用率　c.按需使用按量付费

2. 业务敏捷：a.缩短上线时间　　b.资源弹性扩展　　c.精准营销/风控

3. 精细运营：a.服务度量计费　　b.成本优化控制　　c.数据分析支持

4. 组织优化：a.聚焦核心业务　　b.人员技能优化　　c.组织文化调整

对厂商的影响：
                                     需求巨增，生产销售交付方式产生巨变
1. 终端连接设备　　终端设备商　　　　　智能终端，边缘计算

2. 行业应用/方案　集成商/行ISV　　　　　解决方案型，云化应用　

3. 云平台层　　　　云服务提供商　　　　多元化，产业化，低成本

4. 网络连接层　　　网络集成商　　　　　网络带宽升级，5G

5. 硬件设施层　　　硬件设备商　　　　　白牌化，利润率降低


#### 中国云市场规模

#### 云服务发展阶段

#### 云服务竞争优势

#### 云服务成功案例



### 云服务的产品介绍

#### 地域与可用区

1. 可用区: 同一地域内电力和网络相互独立的物理数据中心[城市＋编号]
2. 地域：一个独立的地理区域，命名［覆盖范围＋机房所在城市］
3. 云服务目前支持25个区域，53个可用区.

部署多地域可用区

1. 就近接入
2. 隔离故障点
3. 负载均衡
4. 保证高可用


#### 云服务器实例

1. 实例：一台完整的云服务器（虚拟机），包含CPU,内存，磁盘，网络，操作系统等组件
2. 命名：系列．机型．规格．（v(虚拟)CPU核数与内存大小）
3. 管理：实例可通过控制台或API管理；实例配置可在线调整，重启生效．
4. 安全：策略控制，安全组，登录控制．

实例类型：通过不同的配置（CPU，内存，IO,网络等）提供不同的IO,计算，存储或网络能力，不同的应用场景．实例族指某一类实例类型的集合．

特征与应用

实例　　　　　主要特点　　　　　　　　　　　应用场景

标准型　　　　均衡计算，内存与网络　　　　　中小型Web应用,中小型数据库等,企业官网．

内存型　　　　大内存　　　　　　　　　　　　大量的内存操作，查找和计算的，分布式内存缓存等

高IO型　　　　高IO高吞吐量低时延　　　　　　NoSQL数据库，集群化数据库，OLTO系统

计算型　　　　高主频CPU,最高性价比　　　　 　高流量Web服务器，MMO游戏服务器，HPC　　　　　　　　　　　　


#### 云服务器镜像
定义：
镜像就像创建云服务气的模板（装机盘），提供云服务器实例所需的操作系统与软件配置等信息．

作用：
1. 批量部署环境
2. 特定软件部署
3. 运行环境备份

四类镜像
1. 共有镜像
2. 服务市场镜像
3. 自定义镜像
4. 共享镜像

镜像优势　　　镜像部署　　　　　　　　　　　　手动部署
部署时长　　　3-5分钟　　　　　　　　　　　　　1-2天
部署过程　　　快速创建合适云服务器　　　　　　自行选择软件，自行安装调试
安全性　　　　云服务测试审核，安全加固　　　　依赖开发部署人员的水平
适用情况　　　四种镜像部署　　　　　　　　　　完全自行配置，无基础设置



#### 云服务器存储

1. 安存储介质: 普通云硬盘，高性能云硬盘，SSD云硬盘（固态盘）

2. 按使用场景:　系统盘， (添加)数据盘

3. 按架构模式：本地盘，云硬盘，对象存储．


#### 云服务器演进

虚拟主机－＞独立主机－＞VPS主机－＞云服务器
虚拟主机：网路服务器上划分出一定的磁盘空间供用户使用的主机．
独立主机：客户独立租用一台服务器来展示自己的网站，
VPS主机：　将一部服务器切分成多个虚拟专享服务器．
云服务器：　在一组集群主机上虚拟出多个类似独立主机的部分.


#### 云服务器CVM

云服务器CVM是一种弹性伸缩的计算服务

1. 弹性计算:分钟级扩展收缩 
2. 灵活配置:配置CPU,内存，带宽等
3. 稳定可靠：可用性99.95%,3副本
4. 管理简单: API/CLI控制台
5. 网络安全: VPC/ACL安全组
6. 全面防护: 木马/漏洞检测，暴力破解防护等．

CVM应用:电商促销业务
需求:
1. 突发流量井喷
2. 保障业务，控制成本
方案：
1. 标准型CVM,镜像
2. 弹性伸缩组：闲时缩减实例数，忙时增加实例数．

#### CPU云服务器
1. 基于GPU应用的计算服务，具有实时高速的并行计算能力和浮点计算能力．
2. 突破传统CPU限制，具有高并行，高吞吐，低时延等特点，科学计算中性能比传统建构提高50倍．

     　　 　 GPU  　　　　　　　　　CPU　

对比　　数千个加速核心　　　　　几十个核心
　　　　
　　　高效众多ALU,多线程　　　　复杂逻辑控制单元　　
　　　　超大并行吞吐量　　　　　强大ALU
      
       计算密集，并行计算　　　　逻辑控制，串行运算

GPU云服务器应用


计算型：

1. 深度学习：深度学习训练和推理，图像识别，语音识别等．
2. 科学计算：计算金融学，地震分析，分子建模，基因组学等．
3. 视频编解码：高清视频转码，安防视频监控，大型视频会议等．


渲染型：

1. 图新工作站：三维设计与渲染，影音动画制作，工作建模与仿真（CAD/CAE）,医学成像，游戏测试等，
2. 非线性编辑: 电影和电视后期制作中的剪接操作，分别进行剪辑，字母，特技，调色，包装等．

GPU云服务器应用: 大数据分析

需求:

1. 用于AI算法建模
2. 高计算能力

方案:

1. 采用GPU实例
2. 缩短深度学习的训练时间
3. 避免昂贵的硬件采购

#### FPGA云服务器

1. 基于FPGA现场可编程阵列的计算服务，可使用FPGA镜像在几分钟内部署FPGA实例，实现硬件加速．

FPGA云服务器优势

产品优势：

1. 硬件加速: FPGA硬件加速器协调执行，运行速度比CPU服务器最高可提升20倍．

2. 硬件可编程：FPGA实例可重复编程，自定义硬件加速，无需重新设计硬件．

3. 产权交易平台：　提供一种规范安全可靠地FPGA硬件平台及FPGA服务市场．

应用场景：深度学习模型，实时图像压缩处理等．


#### 专用宿主机CDH

专用宿主机CDH提供独享宿主机资源的购买，搭载虚拟化平台，可创建云主机．

产品优势:

1. 物理隔离

2. 资源独享

3. 安全合规

4. 灵活配置

CDH应用场景:

1. 金融业务:安全合规．

2. 高性能业务:资源独享

#### 黑石服务器CPM

黑石物理服务器是一种按需购买，按量付费的物理服务器租赁服务，提供云端专用高性能，安全隔离的物理集群．

三种：

1. 黑石Stack-V(深度整合VMware)：

应用：混合云．

深度整合VMware套件，包括vSphere6.5,vSAN6.6,NSX6.3等，VMware许可．通过内网互联，整合众多云服务产品.

2. 黑石ARM服务器(CPM for ARM)

移动游戏场景．

需求：
移动游戏研发需要大量真机测试，手机型号多迭代快，大型游戏安装包很大，户外运营体验成本高．

方案：黑石ARM实例与移动端ARM的CPU采用相同的指令集，可以在ARM上运行Android虚拟器,用于游戏测试和运行．

3. 黑石OpenPOWER服务器(CPM for OpenPOWER)

需求：

大数据处理要求性能，高并发高IO,大内存，高速传输等．

方案：

黑石OpenPOWER具有高主频高，并发线程多，内存宽带大，缓存大等特点．

#### 云服务计费方案

购买渠道：

1. 官网购买

2. API购买:通过API借口购买

计费模式：

1. 包年包月，持续稳定

2. 按量计费，灵活方便

3. 阶梯计价，越多越省

云服务价格计算器

计算相关价格．


#### 包年包月计费模式

1. 包年包月：预估费购买，一次性支付一个月，多个月或多年的费用，支付成功后锁定云资源，知道期末未续费而销毁．
2. 退款说明: 每个账号默认享有依次五天内无理由全额退款.
3. 稳定业务场景，长期使用，追求低成本．
4. 选购->订单->账单->到期处理->续费，

停服回收机制

1. 到期预警 (到期前1-7天)
2. 欠费预警　(到期当天)
3. 资源停服　(到期当天停服后-到到期后第七天)
4. 资源销毁　(到期后第八天)

#### 按量计费模式

1. 按量计费：后付费，根据实际使用量或时长按一定的节短周期进行结算，可随时购买或销毁，可灵活升降配置．
2. 应用场景：业务发展波动大，资源使用有临时性和突发性．
3. 付费流程：充值->开通->冻结->解冻->账单->欠费->充值.

冻结机制；
开通按量计费资源时，系统根据资源结算周期及历史使用情况，预估冻结金额一定的账户余额，下次计费或资源释放时会解冻．
1. 月结
2. 时结或日结

注意：按日支付十五天后费用减至月结费用
停服回收机制

1. 生成账单
2. 欠费保护期
3. 欠费停服期
4. 欠费状态资源回收

#### 云服务计费模式

CVM费用　= 实例费用(CPU + 内存)　+ 存储费用　+ 宽带费用

计费模式:
1. 包年包月：

预付费，一次支付一个月或多个月费用．

2. 按量计费
   
   后付费，按秒计算，按小时结算．
   
   三级阶梯价：0 < t1 <= 96H < t2 < 360h < t3
   
   部分实例支持关机不收费


CVM购买限额

1. 包年包月CVM实例每月新配置额
 
2. 按量付费CVM实例每月新购配额


计费方式总结：

产品　　　　　CVM云服务器　　GPU云服务器　　　FPGA云服务器　　　CDH专用宿主机　　　CPM黑石物理服务器

计费方式　　　1 包年包月　　　同前　　　　1内测阶段申请使用　　　包年包月　　　　　同一
　　　　　　　2 按秒计费　　　　　　　　　价格协商
				按时结算


总结：
云服务基础：地域与可用区，实例，镜像，存储
云服务器产品：CVM,GPU,FPGA,CDH,CPM
云服务器计费方案：按量计费，包年包月，回收机制，冻结机制．

### 云服务网络产品介绍

#### 私有网络VPC

私有网络是用户自定义的，逻辑隔离的专属云上网络空间．
VPC包括：

1. IP/网卡
2. 子网
3. 私有网段
4. 路由表
5. 安全组/ACL

#### VPC私有网段

私有网段：不同企业可以相同，解析时会不同
10.0.0.0-10.255.255.255(掩码16-28)
172.16.0.0-172.31.255.255(掩码16-28)
192.168.0.0-192.168.255.255(掩码16-28)

子网：
1. 云资源需要部署在子网内
2. 通过DHCP获得私有IP,不能在公网路由．
3. 每个子网可用IP数2^n-3(n为主机位的位数)．


#### VPC路由表
VPC内网互通,不同VPC内网不通，通过路由表实现子网间，子网与外部的路由通信．

路由表种类：
1. 默认路由表
2. 自定义路由表

路由策略：
1. 目的端
2. 下一条类型
3. 下一跳

VPC访问控制
1. 网络ACL: 控制进出子网的数据流(入站/出站)
2. 安全组:配置放通或拒绝的端口/协议．

#### 安全组和网络ACL
VPN访问控制
1. 网络ACL: 控制进出子网的数据流(入站/出站)
2. 安全组:配置放通或拒绝的端口/协议．


#### 弹性网卡ENI

弹性网卡：
绑定私有网络内云服务器的一种弹性网络接口，可在云服务器间自由迁移．

ENI优势:
1. 多网卡/IP
2. 灵活迁移
3. 网络隔离


#### 网络连接产品

#### 公网接入
VPC里的服务器分配私有IP,无法访问公网，可以绑定公网IP来实现．
普通公网IP:在CVM上申请绑定，与账号无关，解绑后立即释放，无法返回．

弹性公网IP:（一个服务）
1. EIP 可独立申请，绑定CVM或NAT网关实例．
2. 与账号相关，解绑后继续保留，可重新绑定．
3. 可通过API/控制台主动释放或欠费自动释放.

公网网关：（多个服务）
1. 没有公网IP云服务器，可通过位于不同子网的公网网关访问Internet.
2. 公网网关就是开启了公网转发功能的云主机．
3. 只能在购买服务器时进行配置．
4. 需要建立独立的网关子网．

NAT网关

1. 通过IP地址转换提供Interent访问服务器 
2. SNAT(源网络地址转换) ip1 对应　一个公网端口
3. DATA(目的网络地址转换)　多个ip一个端口对应一个公网端口
4. 网关控流，流量告警，共享带宽包．

NET网关类型
1. 小型(最大100万连接数)
2. 中型(最大300万连接数)
3. 大型(最大1000万连接数)

#### 企业DC链接

专线接入提供与公网完全隔离的物理专线接企业DC与云服务．
产品组成:物理专线，专用通道，专用网关．
产品优势：
1. 网络质量保证
2. 多地域接入
3. 多端口多协议
4. 主备双路接入

应用场景：
1. 混合云
2. DC容灾

VPN连接在Internet上构建一条安全加密的网络隧道，实现本地DC与云服务上的资源联通的网络服务．

产品组成: VPN网关，对端网关，VPN通道．

产品优势: 安全可靠通信，快速弹性部署，监控告警与流量控制．

加密协议：IKE(秘钥交换协议)和IPsec对传输数据进行加密.


对比：

专线接入：　性能强悍，支持NET，部署时间长．
　
VPN接入：　性能较差，不支持NET,实时部署，即买即用．


#### 对等链接
对等链接是一种大带宽，高质量的云上资源互通服务，支持多CPN,多区域,多账户,异构网络互通等．对等连接互通性不传递．

对等连接限制：

1. VPC对等连接的互通性不传递

2. 跨账号对等连接需要对端确认

3. 对等连接两端VPC网段不能重叠.

分两种　
1. 同地域对等连接(免费)
2. 跨地域对等连接


#### 云联网CCN

云联网提供云上VPC,VPC与企业DC(数据中心)间全网互联服．可将VPC和专线关实例计入云联网实现全网互通.



对比项：　　　　对等链接/专线链接　　　　　　云联网CCN

连接性　　　　　单点互联　　　　　　　　　　　一次接入，全网互联，就近接入

网络重叠　　　　VPC网段不重叠　　　　　　　　VPC网段可重叠，子网不可重叠

配置　　　　　　手动配置管理　　　　　　　　　智能学习与调度，路由自动下发


云联网限制：

与对等连接互通性不传递
路由限制：
1. 不同VPN中相同或包含的子网不能互通
2. 不同VPC　CIDR有重叠，若其子网不同，可以互通．
3. 若子网出现冲突，则最先关联云联网的实例生效，后关联无效．（先到先得）

云联网应用:混合云

1. 混合云: 一次接入，全网互联．
2. 游戏加速: 全球布局，就近接入.


#### 负载均衡CLB

负载均衡提供安全快捷的流量分发服务．

工作原理：
1. 虚拟VIP:统一对外服务IP,接受访问请求；	

2. CLB实例:通过监听器监听并分发流量

3. 后端CVM:处理访问请求并返回结果

4. 探测后端CVM的健康状态.

负载均衡优势：

1. 高新能高吞吐量
2. 高可用性 99.95%
3. 安全保障



#### 流量分发算法

多协议转发

四层负载均衡：
监听TCP与UDP,基于端口+VIP转发

七层负载均衡：
监听HTTP与HTTPS,基于内用(域名/URL)转发

流量控制算法
1. 加权轮询算法WRRS:根据新连接数调度，权值高优先链接．（服务时间相同短连接HTTP）(连接的服务器时间差距大)
2. 加权最小链接WLCS: 设置权值wi,当连接次数为ci,流量分派到ci/wi值最小的服务器，（长连接服务时间不同FTP）(最小连接数和会话不能同时开启)
3. 原地址散列IP-Hash：根据请求的源ip地址，使用数列键从静态分配的散列表找出对应服务器（固定分派，会话保持，适合无cookie功能的TCP协议）（服务器数量变化或该服务器不可用时有影响）．

#### 负载均衡类型

1. 公网型比内网型强
2. 应用型比传统型强

应用场景:流量分发/扩展

需求:
1. 业务波峰波谷明显，弹性调控后端资源
2. 业务流量峰值高，需构建低成本架构
3. 如电商促销，金融系统，游戏服务等．

方案：

1. 负载均衡与弹性伸缩．

2. 按需横向扩展/收缩．

横向扩展增加节点，纵向扩展增加规格（内存）.

应用场景:　业务访问分离

通过CLB与CDN将不同流量分发到对应集群，实现文本，图片与视频访问分离，以获得最优的访问体验与性价比．

应用场景：出入流量分离
内部发起与外部访问流量分离，设置不同的处理与安全策略

1. 主动公网访问:通过NAT网关进行私有IP与公有IP地址转换．
2. 响应外网请求：通过负载均衡分发流量，屏蔽后端服务器．

应用场景：混合云

通过负载均衡将业务流量分发到企业数据中心，或共有云上．
，　　
#### 网络产品计费方案

(未看_)

### 云服务CDN加速产品的介绍

#### 内容分发网络
内容分发网络(CDN)通过高性能加速节点提前就近缓存业务内容,实现快速响应，降低用户访问延迟，提升可用性．

CDN解决问题:
1. 物理距离远，多次网络转发，延时高不稳定．
2. 所在运营商不同，需要运营商之间转发绕行．
3. 网络带宽处理能力有限，海量请求时，响应速度与可用性降低．

#### CDN访问原理

传统网站访问

1. 用户输入访问域名：www.baidu,com浏览器将解析请求发往DNS服务器
2. 返回www.baidu.com对应的IP
3. 向IP发送访问请求(向Web访问)
4. 返回用户访问内容

CDN访问原理：

1. 访问域名www.test.com,解析请求发往Local DNS
2. 递归查询Cname解析记录指向www.baidu.com.edu.dnsv1,com(指向Tencent DNS/GSLB)
3. 返回最佳节点IP1（到Local DNS）（离你最近的）
4. 返回最佳节点IP1（到用户） 
5. 用户发起IP1的访问请求到CDN接入点如果有就直接返回
6. 从接入点把内容路由发送到CDN中间源
7. 中间源把CDN回源发送到源站(中间源先把大量数据数据放入筛选回源减小源站压力)
8. 源站返回数据
9. 节点获取数据并缓存
10. 返回用户访问内容

解决问题：

1. 网络绕行
2. 服务质量
3. 安全

#### CDN发展阶段

发展趋势：

1. 价格更低
2. 行业方案
3. 标准化
4. 边缘计算
5. 只能CDN

#### CDN系统架构
CDN架构涵盖:
管理系统，内容系统，监控系统．
#### CDN内容系统

1. 中间源: 提升响应速度，减少源站压力.
2. 双层缓存: 均衡容量，性能与成本.
3. DiskTank3存储引擎: 兼顾海量小文件与大文件访问.
4. NWS服务器: 功能与性能优化(边缘节点)
5. TGW负载均衡: 多网统一接入．

CDN缓存刷新
缓存过期：默认30天．自有原域名接入时常规动态文件过期时间为0;
缓存刷新:

1. URL刷新: 以文件为单位进行缓存刷新．
2. 目录刷新：是以目录为单位，将目录下的所有文件进行缓存刷新．

URL预热：以文件为单位提前将热点资源缓存到边缘节点．


#### CDN监控系统

多维度．全方位的立体化监控与调度，快速发现和剔除异常机器．
1. 动态路由协议OSPF　5秒禁用故障节点
2. 组播心跳机制监控集群，剔出无心跳节点．
3. 区域内节点相互探测，实时剔除异常节点，
可达性，延时，下载速度，丢包率．

GSLB智能调度
探测获取全网链路质量，实时调整调度策略

最优接入:　用户请求会动态调度至最近最优的CDN节点
 
最优回源:　根据全网实时状态监控以及只能路由，选择最优回源链路

动态加速:　为动态请求提供最优链路，有效避开质量较差，比较拥堵的链路.

#### CDN管理系统

1. 资源管理系统

2. 安全管理系统

3. 配置管理系统

4. 客户管理系统

#### CDN接入步骤
添加域名->配置源站信息->选择加速产品->修改CNAME
备案的域名/可访问
自有源/cos源
静态加速下载加速等

#### CDN安全机制

1. SSL安全证书
(HTTPS支持)

2. 移动解析HttpDNS
(移动解析Http DNS)

3. CDN访问控制
CDN访问控制

4. 大禹DDos防护
大禹DDos防护

#### 移动解析HttpDNS
域名劫持：
1. 传统域名解析使用DNS协议向运营商Local DNS发起解析请求：
2. 可能造成运营商的域名劫持（解析到错误的IP）或跨网访问问题

解决方案:移动解析(Http Dns)
1. 使用Http协议向云服务Public DNS服务器发送域名解析请求，获取正确的/最佳IP..
2. 使用HttpDNS时建议保留Local DNS备份.

#### SSL安全证书

HTTP的挑战
1. HTTP协议被用于在Web浏览器和网站服务器之间传递信息
2. HTTP协议传输的数据都是未加密的，也就是明文的

HTTPS = HTTP + SSL
1. 通过加密传输保障数据安全．
2. 通过省份认证保障网站真实性．

云服务SSL证书
提供一站式证书服务,为网站，移动应用提供HTTPS解决方案.
1. 顶级CA机构
2. 兼容性100%
3. 提升搜索排名
4. 数据加密传输

证书类型：
1. 域名型DV:小锁标记+https
2. 企业型Ov:小锁标记+https
3. 增强型EV:小锁标记+https+公司名称

#### CDN访问控制

1. 过滤参数配置
2. 防盗链配置
3. IP黑白名单
4. IP访问限频

#### CDN加速产品

适用场景：针对门户网站，电商，UGC社区等场景，提供了强大的静态内容(如网页时,图片小文件，加速分发处理能力)

下载分发加速：安装包下载，或升级.

音视频加速VCD: 使用场景视频网站，电视盒子等．


#### 海外加速GCD
海外加速:解决跨国访问问题，有效降低访问延迟，支持业务平滑出海.


#### 动态加速网络(DSA)

动态加速网络解决跨境运营商，跨国，网络不稳定等因素导致的响应慢，丢包，服务不稳定等问题，

DSA还支持多链路冗余传输，保障数据在传输过程中的可靠性.

#### 全球应用加速GAAP

接入方式：域名接入，IP接入　
应用场景：跨区域访问加速

#### 边缘计算CDN
CDN能力从缓存分发延迟至边缘计算，通过编程配置等方式将部分处理功能下沉至边缘节点,
产品优势: 减少高网络延迟时，传输负载，以及后端计算处理压力．
应用场景：定制化应用，灰度发布，动态源选择，访问控制．

#### 智能CDN：x-p2p
充分利用边缘计算存储能力和整体网络闲置带宽，结合音视频　SaaS服务，提供更高体验与性价比的流媒体分享方案．

产品优势
1. 比传统的CDN价格低50%
2. 业界最低的延迟技术
3. 智能调度P2P与固定节点
4. 多重机制保障服务质量

#### 带宽计费方案

#### 流量计费方案

#### 计费方案选择 

### 云服务存储产品的介绍
#### 存储类型和特点

块存储:  通过LBA读写数据块，高速传输．　如数据库

文件存储:　通过文件名／目录，读写文件，权限控制．如文件共享

对象存储:　通过对象ID/元数据读写对象（键值）快速读写，视频大文件存储

#### 存储介质

磁盘　HDD机械盘　　　　　　　　　　　SSD固态盘
原理　盘片旋转，磁头读写数据　　　　　主控器通过块地址LBA并发读写
容量　16TB　　　　　　　　　　　　　  47TB
读写次数无限　　　　　　　　　　　　　有限
功耗　大　　　　　　　　　　　　　　　小
恢复　　可　　　　　　　　　　　　　　不可
价格　　低　　　　　　　　　　　　　　高

#### 存储分级
存储分级: 基于数据访问频率，性能要求与成本考虑将数据存放在不同的存储设备上，不同分级存储可以自动迁移．
1. 存储访问局部性
2. 存储方案优化

标准存储：CBS/CFS/COS
低频存储：COS(低频存储)
离线存储：归档存储CAS

#### 云服务存储服务
云存储产品：　云硬盘CBS,文件存储CFS,对象存储COS,归档存储CAS
云存储服务: 存储网关(CSG),运输局迁移CDM,日志服务CLS.
#### 云硬盘CBS
是CVM使用的持久化会级存储服务．

类型：系统盘/数据盘，普通云盘/高性能云盘/SSD云硬盘

#### 文件存储CFS

提高安全可靠，可扩展的共享文件存储服务．
支持NFS v3.0/v4.0, CIFS/SMB协议，支持POSIX访问语义．
用户可以使用标准操作系统挂载命令来挂载文件系统．

#### 对象存储COS

对象存储是无数据格式限制可容纳海量的数据且支持HTTP/HTTPS协议访问的分布式存储管理．

数据以对象心事存放在用户自助创建的存储桶中

可通过按地域分配的域名对cos中的数据直接进行数据访问，下载或管理．



#### 归档存储CAS

归档存储是低成本，高可靠且以管理的云端离线存储服务．
CSA通过文件库Vault来存取档案Archive(存储对象)．

#### 存储网关CSG

#### 云数据迁移CDM

#### 日志服务


### 云服务数据库产品的介绍

#### 数据库类型对比

对比项　               　关系型SQL　　　　　　 　   非关系型NoSQL

数据结构　　　　　　　　　关系表　　　　　　　　　　数据集(键值/JSON文档/哈希表/其他)

模型结构　　　　　　　结构化，提前定义表结构　　　　动态调整模式，非结构化

扩展方式　　　　　　　纵向扩展提高处理能力　　　　　横向扩展，增加分布式节点

数据查询　　　　　　　标准通用的查询语言SQL　　　　　非标准非结构化的查询语言(UnQL)

关键特性　　ACID(原子性,一致性,隔离性，持久性)　　CAP,BASE(分布式结构中满足CAP的其中两个C:一致性 A;可用性 P:分区容错型)（基本可用）

主要优势　　　　　结构化，事物处理，易于维护使用　　扩展性，灵活调整，大数据分析

主要劣势　　　　　扩展性，高并发场景，大数据分析　　事物支持较弱，标准不统一

主流关系型数据库：
1. ORACLE
2. MySql：开源数据库
3. SQL_Server: Windows平台．
4. IBM DB2: 大型机小型机系统中（银行，大企业）（UNix）
5. PostgreSQL: 也是企业首选的.

主流NoSQL数据库　

数据库类型　　　　　　　　关键特点　　　　　　　　　　　　主流产品　　　　　　　　　　　　　应用场景

键值数据库　　　使用哈希表存储键和特定的数据的指针　　　Redis,Memcached               内存缓存，购物车等．

文档数据库　　　以文档形式(JOSN/BSON/XML)存取数据　　　 MonggoDB,CouchDB　　　　　　　应用日志系统，网站/博客平台
　　　　　　　　Schema-Free弱模式结构

列式数据库　　　键仍然存在，但指针指向多个列，以列模式　HBase,Cassandra　　　　　　　　分布式文件系统，大数据分析
　　　　　　　　存储相关数据


图数据库　　　　以图存储数据，实体顶点，边代表关系　　　Neo4J,InfoGrid　　　　　　　　　社交网络，推荐引擎.



#### 数据库排名和发展趋势

DB_Engines Rankiing按月更新数据库流行度排名;

数据库的发展趋势

融合：

1. 软件与硬件融合:数据库一体机
2. NoSQL与SQL融合:NewSQL
3. OLAP(数据分析)与OLTP（数据处理）：HTAP　(有问题！！！！！！！！！！！！！！！！！！！！)
4. DBMS与AI融合
<F7>

突破：

1. 海量数据处理:大数据分析
2. 高性能:集群/分布式/低延时
3. 稳定性:数据复制，备份容灾
4. 架构突破:内核优化/云原生DB




#### 云服务数据库

关系型数据库：

MySql,MariaDB,SQL_Server,PostgreSQL,TDSQL,CynosDB

NoSQL数据库:

Redis, Memcached,MonggoDB,CTSDB,HBase.

数据库服务：

DTS,TData





#### 云数据库MySql

TencentDB for MySql 让用户在云端部署使用MySQL数据库

兼容性：100%兼容开源MySql协议．

性能优化：
1. 深度优化MySql内核．
2. 使用PCI-e SSD 提升I/O性能．
3. 单实例24万QPS,6TB存储空间
4. 一主多从，支持读写分离．

安全保障：
数据加密，数据库审计．

高可用性

1. 实时热备，基于binlog 5日内无损恢复数据 

2. 自动容灭，自动故障检测，主备切换/迁移对用户透明．


MySql应用：　游戏应用场景

也无需求：基于玩家数量变化划分派资源，多时间点的数据保留与回档．
应对方案：弹性扩容，快速回档（游戏复活）．

MySql应用：　移动APP场景

业务特点:　高并发访问，多读少写
应对方案：　读写分离，性能优化．



#### 云数据库SQL_Server
SQL_Server是微软推出的基于Windows系统的商用关系型数据库
TencentDB for SQL service　是具有微软正版授权，可在云端轻松部署使用

支持如下版本

1. SQL service 2008 R2 sp3
2. SQL service 2012 sp3
3. SQL service 2016

产品功能：

预配置参数：

1. 快速启动与连接实例．
2. 简化初始化与参数调优．

数据库镜像：

1. 默认提供一主一镜像．
2. 宕机自检与秒级切换．

备份回档：

1. 定时自动备份保留七天
2. 随时回档到指定时间

SQL server 镜像机制

采用数据库镜像实现高可用复制；

1. 每个库对应一组监控Agent,通过心跳对数据库进行实时监控．

2. 如果节点故障，系统将自动恢复/重建，节点切换对业务透明．

SQL_Server应用: Windows平台　

Windows平台架构及云数据库SQL server可以协助用户快速部署企业OA/ERP/销售管理等移动办公平台．



#### 云数据库PostgreSQL

PostgreSQL 是开源的NewSQL数据库，结合SQL和NoSQL特性，已成为商用首选开源关系数据库．

TencentDB for PostgreSQL让用户在云端轻松设置，操作和扩展

PostgreSQL数据库：

1. 更多的功能特性支持
2. 商用级数据强一致
3. 超高的性能
4. 高可靠性

PostgreSQL应用场景

强大计算性能，空间地理信息处理能力，适用于面向企业复杂SQL处理的OLAP或OLTP场景．

1. 企业核心应用：如ERP,交易系统，财务系统等．
2. 含LBS的应用:大型游戏，O2O等应用．
3. 数据仓库和大数据: 支持更多数据类型和高级分析功能．
4. 建站或APP: 自定义函数，数据格式，全文搜索功能．

OLTP与OLAP对比
特点　　　　　　　OLTP             OLAP

主要场景　　　　日常交易处理　　　统计，报表，分析

面向业务　　　　面向实时交易类，　面向统计分析的如ERP,BI等
　　　　　　　　如电商交易，订单

性能消耗　　　　磁盘IO            cpu

实时性　　　　　实时读写要求高　　实时读写要求低　
　

#### 云数据库MariaDB_TDSQL

MariaDB由MySQL创始人创立,承诺永远开源，高度兼容MySQL.

TencentDB for MariaDB定位于高安全性高性能的企业级云数据库．

分布式数据库TDSQL:
TDSQL是云服务维护的金融级分布式架构MariaDB内核分支；支持自动水平拆分，业务感受完整的逻辑表，数据均匀拆分到物理分片中，TDSQL解决问题

1. 单机数据库到达瓶颈．
2. 应用层分片开发工作量大．
3. 开源NoSQL运维支持不足．

MariaDB产品优势：

强同步MAR:

1. 强同步保障数据的一致性
2. 改造线程池模型提升新能．
3. 满足金融级强一致性要求．

高可用：

1. 一主多从透明故障切换． 
2. 实时自动实例监控与修复
3. 多可用区部署，备份回档

高性能：
1. 面向OLTP场景
2. 深度定制优化内核
3. 读写分离扩展性能．

数据复制方式：

1. 异步复制（可能产生数据不一致的情况）
2. 半同步复制
3. 强同步赋值

MAR强同步

腾讯自研的异步多线程强同步复制方案(MAR)

1. 数据强一致:每个节点都包含完整数据副本,可以随时切换；
2. 业务层透明：业务层面无需要读写分离或同步强化工作；
3. 性能优化：将串行同步线程异步化，引入线程池能力，
4. 自动管控: 支持自动成员控制，故障节点自动从集群中移除．

TDSQL水平拆分机制

1. 垂直切分:就是按业务应用切分不同内容分派到不同数据库中．
2. 水平切分将一个表的数据分散到多个物理独立的数据库服务器中．

TDSQL Share-Nothing架构

Share-Everhing 
DB下边是Disk

Share-Storge
多个并联DB连接到一个SAN/共享内存

Share-Nothing

顶层Proxy/Master连接多个并联DB,每个DB下边链接一个Disk.


#### 云数据库CynosDB

#### 云数据库MonggoDB

#### 云数据库Redis

#### 云数据库Memcached

#### 时序数据库CTSDB

#### 数据库一体机TData

#### 数据库传输服务DTS

#### 关系数据库计费方案

#### MonggoDB计费方案

#### Redis计费方案

#### Memcached计费方案.


### 云服务安全产品的介绍


### 云服务视频与通信服务介绍








